<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>polyUAnalog: As3397 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="polyUAnalog.png"/></td>
  <td id="projectalign">
   <div id="projectname">polyUAnalog<span id="projectnumber">&#160;4.33</span>
   </div>
   <div id="projectbrief">A Polyphonic Analogic and Open Source Synth</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('class_as3397.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_as3397-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">As3397 Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Class to manage the AS3397 module with "PWM-DAC" for the CV-control.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="as3397_8h_source.html">as3397.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aae521aac779040fbec4633274c91b68e" id="r_aae521aac779040fbec4633274c91b68e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aae521aac779040fbec4633274c91b68e">As3397</a> (uint32_t srate)</td></tr>
<tr class="memdesc:aae521aac779040fbec4633274c91b68e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for <a class="el" href="class_as3397.html" title="Class to manage the AS3397 module with &quot;PWM-DAC&quot; for the CV-control.">As3397</a>. Filtered "PWM-DAC" are initialized and default waveform and frequency are set for DCOA and DCOB.  <br /></td></tr>
<tr class="separator:aae521aac779040fbec4633274c91b68e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28b4b173bf82ba698138b7e17b5bd97b" id="r_a28b4b173bf82ba698138b7e17b5bd97b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_p_w_mslice_channel.html">PWMsliceChannel</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a28b4b173bf82ba698138b7e17b5bd97b">set_gpio_pwm</a> (uint gpioCV, uint32_t resolution)</td></tr>
<tr class="memdesc:a28b4b173bf82ba698138b7e17b5bd97b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures a GPIO pin for "PWM-DAC" output.  <br /></td></tr>
<tr class="separator:a28b4b173bf82ba698138b7e17b5bd97b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9ae327b3d29ac8e608ea3688f382fbe" id="r_af9ae327b3d29ac8e608ea3688f382fbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af9ae327b3d29ac8e608ea3688f382fbe">set_DcoA_freq</a> (float freq, bool RAZIntegrator)</td></tr>
<tr class="memdesc:af9ae327b3d29ac8e608ea3688f382fbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the frequency of DCO A.  <br /></td></tr>
<tr class="separator:af9ae327b3d29ac8e608ea3688f382fbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2b7d32d073fd9aeb3615d4a5e8627bc" id="r_ae2b7d32d073fd9aeb3615d4a5e8627bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae2b7d32d073fd9aeb3615d4a5e8627bc">set_DcoB_freq</a> (float freq, bool RAZIntegrator)</td></tr>
<tr class="memdesc:ae2b7d32d073fd9aeb3615d4a5e8627bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the frequency of DCO B.  <br /></td></tr>
<tr class="separator:ae2b7d32d073fd9aeb3615d4a5e8627bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fdb19d3c36d919261e3ddc72db464fc" id="r_a7fdb19d3c36d919261e3ddc72db464fc"><td class="memItemLeft" align="right" valign="top"><a id="a7fdb19d3c36d919261e3ddc72db464fc" name="a7fdb19d3c36d919261e3ddc72db464fc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_DcoFM</b> (int FMmod)</td></tr>
<tr class="separator:a7fdb19d3c36d919261e3ddc72db464fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26aea1a51f8fcb77c75cc302fa5e197f" id="r_a26aea1a51f8fcb77c75cc302fa5e197f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26aea1a51f8fcb77c75cc302fa5e197f">set_DcoA_pw_cv</a> (int32_t level)</td></tr>
<tr class="memdesc:a26aea1a51f8fcb77c75cc302fa5e197f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the pulse width control voltage (PW CV) for DCO A.  <br /></td></tr>
<tr class="separator:a26aea1a51f8fcb77c75cc302fa5e197f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c7aeb80456789619fd09220ececf4b3" id="r_a0c7aeb80456789619fd09220ececf4b3"><td class="memItemLeft" align="right" valign="top"><a id="a0c7aeb80456789619fd09220ececf4b3" name="a0c7aeb80456789619fd09220ececf4b3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_DcoB_pw_cv</b> (int32_t level)</td></tr>
<tr class="separator:a0c7aeb80456789619fd09220ececf4b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24f6d5b50afc588a85fa0f15c8bfe8ff" id="r_a24f6d5b50afc588a85fa0f15c8bfe8ff"><td class="memItemLeft" align="right" valign="top"><a id="a24f6d5b50afc588a85fa0f15c8bfe8ff" name="a24f6d5b50afc588a85fa0f15c8bfe8ff"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_Balance_cv</b> (int32_t level)</td></tr>
<tr class="separator:a24f6d5b50afc588a85fa0f15c8bfe8ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafe014520052021b80373a19a980e347" id="r_aafe014520052021b80373a19a980e347"><td class="memItemLeft" align="right" valign="top"><a id="aafe014520052021b80373a19a980e347" name="aafe014520052021b80373a19a980e347"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_Mod_amount_cv</b> (int32_t level)</td></tr>
<tr class="separator:aafe014520052021b80373a19a980e347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace918b281148289207c314fdee0e36cc" id="r_ace918b281148289207c314fdee0e36cc"><td class="memItemLeft" align="right" valign="top"><a id="ace918b281148289207c314fdee0e36cc" name="ace918b281148289207c314fdee0e36cc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_Filter_freq_cv</b> (int32_t level)</td></tr>
<tr class="separator:ace918b281148289207c314fdee0e36cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7f5e894f151dcb54c9238ef1b04976" id="r_a5f7f5e894f151dcb54c9238ef1b04976"><td class="memItemLeft" align="right" valign="top"><a id="a5f7f5e894f151dcb54c9238ef1b04976" name="a5f7f5e894f151dcb54c9238ef1b04976"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_Filter_res_cv</b> (int32_t level)</td></tr>
<tr class="separator:a5f7f5e894f151dcb54c9238ef1b04976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0818ee4fd1a909720f7f00050bf9350b" id="r_a0818ee4fd1a909720f7f00050bf9350b"><td class="memItemLeft" align="right" valign="top"><a id="a0818ee4fd1a909720f7f00050bf9350b" name="a0818ee4fd1a909720f7f00050bf9350b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_Vca_cv</b> (int32_t level)</td></tr>
<tr class="separator:a0818ee4fd1a909720f7f00050bf9350b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ae97d6498f82588ec687d27b3dd5239" id="r_a4ae97d6498f82588ec687d27b3dd5239"><td class="memItemLeft" align="right" valign="top"><a id="a4ae97d6498f82588ec687d27b3dd5239" name="a4ae97d6498f82588ec687d27b3dd5239"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>set_Pan_cv</b> (int32_t level)</td></tr>
<tr class="separator:a4ae97d6498f82588ec687d27b3dd5239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37ea13fe0ca185293c9f024758add22f" id="r_a37ea13fe0ca185293c9f024758add22f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a37ea13fe0ca185293c9f024758add22f">set_Wave_Select</a> (uint8_t wave)</td></tr>
<tr class="memdesc:a37ea13fe0ca185293c9f024758add22f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the wave selection via the quad mixer.  <br /></td></tr>
<tr class="separator:a37ea13fe0ca185293c9f024758add22f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68b04d026aaa7d678c6d6dc490012566" id="r_a68b04d026aaa7d678c6d6dc490012566"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a68b04d026aaa7d678c6d6dc490012566">set_WaveshapeFactorDcoA</a> (uint8_t waveshape)</td></tr>
<tr class="memdesc:a68b04d026aaa7d678c6d6dc490012566"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the waveshape factor for DCO A.  <br /></td></tr>
<tr class="separator:a68b04d026aaa7d678c6d6dc490012566"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c2ad6bd2c839e94ee4b31434f9f191b" id="r_a6c2ad6bd2c839e94ee4b31434f9f191b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6c2ad6bd2c839e94ee4b31434f9f191b">set_WaveshapeFactorDcoB</a> (uint8_t waveshape)</td></tr>
<tr class="memdesc:a6c2ad6bd2c839e94ee4b31434f9f191b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the waveshape factor for DcoB. See set_WaveshapeFactorDcoA documentation.  <br /></td></tr>
<tr class="separator:a6c2ad6bd2c839e94ee4b31434f9f191b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a6ff1c0ec9c21dd66a07164effc0ad" id="r_a81a6ff1c0ec9c21dd66a07164effc0ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81a6ff1c0ec9c21dd66a07164effc0ad">updateDcoA</a> ()</td></tr>
<tr class="memdesc:a81a6ff1c0ec9c21dd66a07164effc0ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the frequency of DcoA.  <br /></td></tr>
<tr class="separator:a81a6ff1c0ec9c21dd66a07164effc0ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0730b6270f015b583320e5295629e3b6" id="r_a0730b6270f015b583320e5295629e3b6"><td class="memItemLeft" align="right" valign="top"><a id="a0730b6270f015b583320e5295629e3b6" name="a0730b6270f015b583320e5295629e3b6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>updateDcoB</b> ()</td></tr>
<tr class="memdesc:a0730b6270f015b583320e5295629e3b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the frequency of DcoB. <br /></td></tr>
<tr class="separator:a0730b6270f015b583320e5295629e3b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66476e4b8fa2abe544dc64af9865f3a0" id="r_a66476e4b8fa2abe544dc64af9865f3a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a66476e4b8fa2abe544dc64af9865f3a0">DSO</a> (int32_t wave)</td></tr>
<tr class="memdesc:a66476e4b8fa2abe544dc64af9865f3a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the output waveform for <a class="el" href="class_d_s_o.html">DSO</a> (Digital Signal Oscillator)  <br /></td></tr>
<tr class="separator:a66476e4b8fa2abe544dc64af9865f3a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eb91acc16c011bcc7e61dd308eec435" id="r_a5eb91acc16c011bcc7e61dd308eec435"><td class="memItemLeft" align="right" valign="top"><a id="a5eb91acc16c011bcc7e61dd308eec435" name="a5eb91acc16c011bcc7e61dd308eec435"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>updatePID</b> (void)</td></tr>
<tr class="memdesc:a5eb91acc16c011bcc7e61dd308eec435"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the PID control loop for the maximum value of the DCO ramp (and consequently the waveshape at the output of the waveshapper) <br /></td></tr>
<tr class="separator:a5eb91acc16c011bcc7e61dd308eec435"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to manage the AS3397 module with "PWM-DAC" for the CV-control. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aae521aac779040fbec4633274c91b68e" name="aae521aac779040fbec4633274c91b68e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae521aac779040fbec4633274c91b68e">&#9670;&#160;</a></span>As3397()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">As3397::As3397 </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>srate</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for <a class="el" href="class_as3397.html" title="Class to manage the AS3397 module with &quot;PWM-DAC&quot; for the CV-control.">As3397</a>. Filtered "PWM-DAC" are initialized and default waveform and frequency are set for DCOA and DCOB. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">srate</td><td>Sample rate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a66476e4b8fa2abe544dc64af9865f3a0" name="a66476e4b8fa2abe544dc64af9865f3a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66476e4b8fa2abe544dc64af9865f3a0">&#9670;&#160;</a></span>DSO()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void As3397::DSO </td>
          <td>(</td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>wave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the output waveform for <a class="el" href="class_d_s_o.html">DSO</a> (Digital Signal Oscillator) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wave</td><td>Is the 16 bit value of the sound generated by the <a class="el" href="class_d_s_o.html">DSO</a>. It is sent to the two 8 bit "PWM-DAC" (low pas filtered PWM) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af9ae327b3d29ac8e608ea3688f382fbe" name="af9ae327b3d29ac8e608ea3688f382fbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9ae327b3d29ac8e608ea3688f382fbe">&#9670;&#160;</a></span>set_DcoA_freq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void As3397::set_DcoA_freq </td>
          <td>(</td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>freq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>RAZIntegrator</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the frequency of DCO A. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freq</td><td>The desired frequency in Hz. </td></tr>
    <tr><td class="paramname">RAZIntegrator</td><td>If true, resets the phase accumulator.</td></tr>
  </table>
  </dd>
</dl>
<p>This function adjusts the frequency of the digitally controlled oscillator (DCO A). It performs the following actions:</p><ul>
<li>Updates the phase increment based on the desired frequency.</li>
<li>Manages frequency-dependent scaling using a MOSFET switch that modifies the resistance value, thereby adjusting the charging current of the DCO capacitor.</li>
<li>Adjusts the proportional and integral control parameters for the PID feedback loop, which controls the maximum charging voltage of the DCO. This, in turn, influences the DCO waveform through the waveshaper.</li>
<li>If requested, resets the integrator error accumulator of the PID controller.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freq</td><td>The desired frequency in Hz. </td></tr>
    <tr><td class="paramname">RAZIntegrator</td><td>If true, resets the integrator error accumulator. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a26aea1a51f8fcb77c75cc302fa5e197f" name="a26aea1a51f8fcb77c75cc302fa5e197f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26aea1a51f8fcb77c75cc302fa5e197f">&#9670;&#160;</a></span>set_DcoA_pw_cv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void As3397::set_DcoA_pw_cv </td>
          <td>(</td>
          <td class="paramtype">int32_t</td>          <td class="paramname"><span class="paramname"><em>cv</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the pulse width control voltage (PW CV) for DCO A. </p>
<p>This function adjusts the pulse width modulation (PWM) of the square part of DCO A <br  />
 based on the provided control voltage (CV).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cv</td><td>The control voltage value for pulse width adjustment. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ae2b7d32d073fd9aeb3615d4a5e8627bc" name="ae2b7d32d073fd9aeb3615d4a5e8627bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2b7d32d073fd9aeb3615d4a5e8627bc">&#9670;&#160;</a></span>set_DcoB_freq()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void As3397::set_DcoB_freq </td>
          <td>(</td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>freq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>RAZIntegrator</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the frequency of DCO B. </p>
<p>See set_DcoA_freq documentation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freq</td><td>The desired frequency in Hz. </td></tr>
    <tr><td class="paramname">RAZIntegrator</td><td>If true, resets the integrator error accumulator. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a28b4b173bf82ba698138b7e17b5bd97b" name="a28b4b173bf82ba698138b7e17b5bd97b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28b4b173bf82ba698138b7e17b5bd97b">&#9670;&#160;</a></span>set_gpio_pwm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_p_w_mslice_channel.html">PWMsliceChannel</a> As3397::set_gpio_pwm </td>
          <td>(</td>
          <td class="paramtype">uint</td>          <td class="paramname"><span class="paramname"><em>gpioCV</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>resolution</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures a GPIO pin for "PWM-DAC" output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gpioCV</td><td>GPIO pin number. </td></tr>
    <tr><td class="paramname">resolution</td><td>PWM resolution that also sets the resolution for the corresponding DAC </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="struct_p_w_mslice_channel.html" title="Structure to define a PWM slice and its properties. This PWM signal is low-pass filtered in order to ...">PWMsliceChannel</a> structure containing the slice and channel. </dd></dl>

</div>
</div>
<a id="a37ea13fe0ca185293c9f024758add22f" name="a37ea13fe0ca185293c9f024758add22f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37ea13fe0ca185293c9f024758add22f">&#9670;&#160;</a></span>set_Wave_Select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void As3397::set_Wave_Select </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>wave</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the wave selection via the quad mixer. </p>
<p>The quad mixer has two binary inputs, resulting in four possible states:</p><ul>
<li><b>WAVE_AB</b>: Both DCO A and DCO B are active (+ square waves A and B).</li>
<li><b>WAVE_B</b>: Only DCO B is active, while DCO A is muted (+ square waves A and B).</li>
<li><b>WAVE_A</b>: Only DCO A is active, while DCO B is muted (+ square waves A and B).</li>
<li><b>WAVE_NONE</b>: Both DCOs are muted, <b>BUT</b> the square comparators still emit a square wave. <br  />
 If the duty cycle is set to 0, the analog oscillators are muted, but the Digital Signal Oscillator (<a class="el" href="class_d_s_o.html">DSO</a>) may still be active.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wave</td><td>The wave selection index. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a68b04d026aaa7d678c6d6dc490012566" name="a68b04d026aaa7d678c6d6dc490012566"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68b04d026aaa7d678c6d6dc490012566">&#9670;&#160;</a></span>set_WaveshapeFactorDcoA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void As3397::set_WaveshapeFactorDcoA </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>waveshape</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the waveshape factor for DCO A. </p>
<p>The voltage ramp at the charging capacitor is sent to the waveshaper. <br  />
 Depending on the maximum value of the ramp, different waveforms are generated, <br  />
 ranging from a sawtooth to a clipped triangle, passing through a pure triangle. <br  />
</p>
<p>Currently, four waveshapes have been implemented: saw, triangle, and clipped triangle. <br  />
 However, intermediate waveshapes or even waveshape modulation are entirely possible.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">waveshape</td><td>Waveshape factor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6c2ad6bd2c839e94ee4b31434f9f191b" name="a6c2ad6bd2c839e94ee4b31434f9f191b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c2ad6bd2c839e94ee4b31434f9f191b">&#9670;&#160;</a></span>set_WaveshapeFactorDcoB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void As3397::set_WaveshapeFactorDcoB </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>waveshape</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the waveshape factor for DcoB. See set_WaveshapeFactorDcoA documentation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">waveshape</td><td>Waveshape factor. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a81a6ff1c0ec9c21dd66a07164effc0ad" name="a81a6ff1c0ec9c21dd66a07164effc0ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81a6ff1c0ec9c21dd66a07164effc0ad">&#9670;&#160;</a></span>updateDcoA()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void As3397::updateDcoA </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the frequency of DcoA. </p>
<p>Updates the phase accumulator, discharges the DCO capacitor if needed, <br  />
 and applies PI control to the DCO A waveshape.</p>
<p>This function updates the phase accumulator for DCO A and applies <br  />
 a Proportional-Integral (PI) control loop to regulate the amplitude <br  />
 of the charging capacitor ramp. The PI controller adjusts the current <br  />
 flowing into the capacitor, ensuring proper waveform generation. <br  />
</p>
<p>The process includes:</p><ul>
<li>Updating the phase accumulator.</li>
<li>If the phase accumulator exceeds <code>PhaseInc</code> (whose value depends on the desired frequency), then:<ul>
<li>Reading the peak value of the analog ramp signal. Since the capacitor is about to discharge, <br  />
 this corresponds to the maximum ramp voltage. This value, processed by the waveshaper, <br  />
 defines the DCO waveform.</li>
<li>Discharging the capacitor by briefly activating the MOSFET transistor, which shorts the <br  />
 capacitor to ground. The duration of this pulse is determined by the execution time <br  />
 of the following instructions (i.e. in beetween "gpio_put(DCOA_FREQ, true);" and "gpio_put(DCOA_FREQ, false);"). It should be sufficient to fully discharge the capacitor, <br  />
 which takes a few microseconds due to the MOSFET's residual resistance.</li>
<li>Computing the error for amplitude control. To maintain a consistent waveform across all frequencies, <br  />
 the maximum ramp voltage must be dynamically adjusted by modifying the charging voltage. <br  />
 This is controlled via the "Waveshape A" control voltage (<code>VWFA_MSB_CV_sliceNum</code> and <br  />
 <code>VWFA_LSB_CV_sliceNum</code> variables).</li>
<li>Applying the PI controller to adjust the charging current.</li>
<li>Setting PWM-DAC values to regulate the capacitor charge rate. </li>
</ul>
</li>
</ul>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="as3397_8h_source.html">as3397.h</a></li>
<li><b>as3397.cpp</b></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_as3397.html">As3397</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
